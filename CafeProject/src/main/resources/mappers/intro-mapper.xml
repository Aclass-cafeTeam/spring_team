<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="introMapper">
	
		<resultMap type="IntroBoard" id="introBoard_rm">
			  <id property="boardNo" column="BOARD_NO"/>
        <result property="boardCode" column="BOARD_CODE"/>
				<result property="boardTitle" column="BOARD_TITLE"/>
	      <result property="readCount" column="READ_COUNT"/>
	      <result property="boardDeleteFlag" column="BOARD_DEL_FL"/>
	      <result property="commentCount" column="COMMENT_COUNT"/>
	      <result property="boardCount" column="BOARD_COUNT"/>
	      <result property="noticeFl" column="NOTICE_FL"/>
	      <result property="commentNo" column="COMMENT_NO"/>
	      <result property="commentDelFl" column="COMMENT_DEL_FL"/>
	      <result property="memberNickname" column="MEMBER_NICKNAME"/>
		</resultMap>
		

		
		<!-- 전체글조회 -->
		<select id="selectBoardList" parameterType="_int" resultMap="introBoard_rm">
			SELECT BOARD_NO, BOARD_TITLE, BOARD_CODE, READ_COUNT,
			(SELECT COUNT(*) FROM "COMMENT" C
			WHERE C.BOARD_NO = B.BOARD_NO) COMMENT_COUNT
			FROM "BOARD" B
			WHERE BOARD_DEL_FL = 'N'
			ORDER BY BOARD_NO DESC
		</select>
		
		<!-- 전체공지만 조회 -->
		<select id="selectNoticeList" parameterType="_int" resultMap="introBoard_rm">
			SELECT BOARD_NO, BOARD_TITLE, BOARD_CODE, READ_COUNT,
				(SELECT COUNT(*) FROM "COMMENT" C
				WHERE C.BOARD_NO = B.BOARD_NO) COMMENT_COUNT
			FROM "BOARD" B
			WHERE NOTICE_FL = 2
			ORDER BY BOARD_NO DESC
		</select>
		
		<!-- 여행후기 게시판 글 조회 -->
		<select id="selectTravelReview" parameterType="_int" resultMap="introBoard_rm">
			SELECT BOARD_NO, BOARD_CODE, BOARD_TITLE, MEMBER_NICKNAME, READ_COUNT, 
							(SELECT COUNT(*) FROM "COMMENT" C
							WHERE C.BOARD_NO =B.BOARD_NO) COMMENT_COUNT
			FROM BOARD B
			JOIN MEMBER USING(MEMBER_NO)
			WHERE BOARD_DEL_FL = 'N'
			AND BOARD_CODE = 12
			ORDER BY BOARD_NO DESC
		</select>
		
		<!-- 대분류(카테고리 리스트) -->
		<select id="selectMainList" resultType="map">
			SELECT * FROM MAIN_CATEGORY WHERE CATEGORY_DEL_FL='N'
		</select>
	
		<!-- 당일 방문자수 조회 -->
		<select id="selectTodayVisit" resultType="_int">
				SELECT COUNT(*)
				FROM LOGIN_HISTORY
				WHERE TO_CHAR(LOGIN_DATE , 'YYYYMMDD' ) = TO_CHAR( SYSDATE, 'YYYYMMDD')
		</select>
		
		<!-- 전체 방문자수 조회 -->
		<select id="selectAllVisit" resultType="_int">
			SELECT COUNT(*) FROM LOGIN_HISTORY
		</select>
		
		<!-- 하루전 댓글 랭킹 -->
		<select id="commentRank" parameterType="_int" resultMap="introBoard_rm">
				SELECT MEMBER_NICKNAME, MEMBER_NO, (SELECT COUNT(COMMENT_NO)
				FROM "COMMENT"C
				WHERE M.MEMBER_NO=C.MEMBER_NO
				AND TO_CHAR(C.C_CREATE_DATE, 'YYYYMMDD' ) = TO_CHAR( SYSDATE-1, 'YYYYMMDD'))COMMENT_COUNT
				FROM "MEMBER" M
				ORDER BY COMMENT_COUNT DESC
		</select>
		
		<!-- 하루전 게시글 랭킹 -->
		<select id="boardRank" parameterType="_int" resultMap="introBoard_rm">
				SELECT MEMBER_NICKNAME, MEMBER_NO, (SELECT COUNT(BOARD_NO)
				FROM "BOARD"B
				WHERE M.MEMBER_NO=B.MEMBER_NO
				AND TO_CHAR(B.B_CREATE_DATE, 'YYYYMMDD' ) = TO_CHAR( SYSDATE-1, 'YYYYMMDD'))BOARD_COUNT
				FROM "MEMBER" M
				ORDER BY BOARD_COUNT DESC
		</select>

      
 
 
</mapper>
